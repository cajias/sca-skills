# Canonical Python Ruff Configuration
# This configuration enforces strict code quality standards with minimal ignores.
# Use this as a shared configuration for all Python projects.
#
# Recommended Setup (version-managed via pip):
# 1. Install the package:
#    pip install agentic-guardrails
#
# 2. Get the config path:
#    python -c "from lint_configs import get_ruff_config_path; print(get_ruff_config_path())"
#
# 3. In your project's pyproject.toml, add:
#    [tool.ruff]
#    extend = "/path/from/step2"  # Use the path from step 2
#    target-version = "py39"  # Your Python version
#
#    [tool.ruff.lint.isort]
#    known-first-party = ["your_package"]  # Add your package name
#
# To update: pip install --upgrade agentic-guardrails
#
# Alternative Setup (home directory):
# 1. curl -o ~/.ruff.toml "https://raw.githubusercontent.com/cajias/lint-configs/main/python/ruff.toml"
# 2. In pyproject.toml: extend = "${HOME}/.ruff.toml"
# 3. To update: Re-run the curl command

line-length = 120
target-version = "py39"

[lint]
# Enable comprehensive linting for code quality, duplication, and dead code detection
select = [
    "E",     # pycodestyle errors
    "F",     # Pyflakes (includes unused imports F401, unused variables F841)
    "I",     # isort (import sorting)
    "B",     # flake8-bugbear (common bugs)
    "W",     # pycodestyle warnings
    "C90",   # McCabe complexity
    "SIM",   # flake8-simplify (detect overly complex code)
    "PIE",   # flake8-pie (miscellaneous lints, includes unused variables)
    "PLR",   # Pylint refactoring (duplicate code, too many args, etc.)
    "RET",   # flake8-return (return statement issues)
    "ANN",   # flake8-annotations (require type hints)
    "UP",    # pyupgrade (use modern Python syntax)
    "D",     # pydocstyle (docstring conventions)
    "N",     # pep8-naming
    "S",     # flake8-bandit (security issues)
    "BLE",   # flake8-blind-except
    "A",     # flake8-builtins (avoid shadowing builtins)
    "COM",   # flake8-commas
    "C4",    # flake8-comprehensions
    "DTZ",   # flake8-datetimez (timezone-aware datetime)
    "T10",   # flake8-debugger (no debugger statements)
    "EM",    # flake8-errmsg
    "ISC",   # flake8-implicit-str-concat
    "ICN",   # flake8-import-conventions
    "G",     # flake8-logging-format
    "INP",   # flake8-no-pep420
    "PT",    # flake8-pytest-style
    "Q",     # flake8-quotes
    "RSE",   # flake8-raise
    "SLOT",  # flake8-slots
    "TID",   # flake8-tidy-imports
    "TCH",   # flake8-type-checking (detect unused imports in type checking blocks)
    "ARG",   # flake8-unused-arguments (detect unused function arguments)
    "PTH",   # flake8-use-pathlib
    "ERA",   # eradicate (detect commented-out code - DEAD CODE DETECTION)
    "PGH",   # pygrep-hooks
    "PL",    # Pylint (all rules, includes unreachable code W0101, pointless statements W0104)
    "TRY",   # tryceratops (exception handling)
    "FLY",   # flynt (f-string conversion)
    "PERF",  # Perflint (performance anti-patterns)
    "RUF",   # Ruff-specific rules (includes RUF100 - unused noqa comments)
]

# Only ignore rules that conflict with Black or are false positives
ignore = [
    "E203",  # Whitespace before ':' (conflicts with Black)
    "E501",  # Line too long (handled by Black)
]

# Configure per-file ignores for test files
[lint.per-file-ignores]
"tests/**/*.py" = [
    "S101",    # Allow assert statements in tests
    "ANN001",  # Missing type annotation for function argument
    "ANN201",  # Missing return type annotation
    "PLR2004", # Allow magic values in tests
    "PLR0913", # Allow many arguments in test functions
]
"**/test_*.py" = [
    "S101",    # Allow assert statements in tests
    "ANN001",  # Missing type annotation for function argument
    "ANN201",  # Missing return type annotation
    "PLR2004", # Allow magic values in tests
    "PLR0913", # Allow many arguments in test functions
]

# Configure complexity thresholds
[lint.mccabe]
max-complexity = 10  # Flag functions with complexity > 10

[lint.pylint]
max-args = 5  # Maximum number of arguments for a function
max-branches = 12  # Maximum number of branches in a function
max-returns = 6  # Maximum number of return statements
max-statements = 50  # Maximum number of statements in a function

# Pydocstyle configuration
[lint.pydocstyle]
convention = "google"  # Use Google-style docstrings

# isort configuration
[lint.isort]
known-first-party = []  # Add your package names here in your project's pyproject.toml
force-single-line = false
lines-after-imports = 2
